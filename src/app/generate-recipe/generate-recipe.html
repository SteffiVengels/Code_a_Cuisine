<div class="container">
    <main>
        <h2>Generate recipe</h2>
        <span>Got random stuff in your kitchen? Pop it in-we've got the perfect recipe waiting.</span>

        <!-- Two-column layout -->
        <div class="ingredients-grid">
            <!-- Left: input form -->
            <div class="panel">
                <form id="ingredientForm" (ngSubmit)="onSubmit()">
                    <div class="ingredientName">
                        <label for="ingredientName">Ingredient</label>
                        <input id="ingredientName" name="ingredientName" type="text" required
                            [(ngModel)]="ingredientName">
                    </div>

                    <div class="servingSize">
                        <label for="servingSize">Serving size</label>
                        <div class="servingSizeInputGroup">
                            <input id="servingSize" name="servingSize" type="number" min="0" step="any"
                                placeholder="100" required [(ngModel)]="servingSize">
                            <select id="servingSizeUnit" name="servingSizeUnit" required [(ngModel)]="servingSizeUnit">
                                <option value="gram">gram</option>
                                <option value="piece">piece</option>
                                <option value="ml">ml</option>
                            </select>
                            <button id="addBtn" type="submit" title="Add">
                            </button>
                        </div>
                    </div>
                </form>
            </div>

            <!-- Right: list -->
            <div class="panel listPanel">
                <p>List of your ingredients</p>
                <ol id="ingredientsList">
                    @if ((ingredients$ | async)?.length === 0) {
                    <div id="emptyState">No ingredients yet.</div>
                    }
                    @for (item of ingredients$ | async; track $index) {
                    <li [class.editing]="editingId === item.id">
                        <div class="list-item">
                            @if (editingId === item.id) {
                                <!-- Edit-Modus: gleiche Struktur wie beim Hinzufügen -->
                                <div class="list-content edit">
                                    <!-- NEU: manueller Bullet wie im Anzeige-Modus -->
                                    <p>•</p>
                                    <div class="servingSizeInputGroup">
                                        <input
                                            type="number"
                                            min="0"
                                            step="any"
                                            placeholder="100"
                                            [(ngModel)]="editServingSize"
                                            [style.width.px]="36" />
                                        <select [(ngModel)]="editServingSizeUnit">
                                            <option value="gram">gram</option>
                                            <option value="piece">piece</option>
                                            <option value="ml">ml</option>
                                        </select>
                                    </div>
                                    <span>{{ item.ingredientName }}</span>
                                </div>
                                <div class="list-actions">
                                    <button type="button" (click)="onSaveEdit(item)" class="save-btn"></button>
                                    <button type="button" (click)="onDelete(item)" class="delete-btn"></button>
                                </div>
                            } @else {
                                <!-- Anzeige-Modus -->
                                <div class="list-content">
                                    <span>• {{ item.servingSize }}{{ item.servingSizeUnit === 'piece' ? '' :
                                        (item.servingSizeUnit === 'gram' ? 'g' : item.servingSizeUnit) }}</span>
                                    <span>{{ item.ingredientName }}</span>
                                </div>
                                <div class="list-actions">
                                    <button type="button" (click)="onEdit(item)" class="edit-btn"></button>
                                    <button type="button" (click)="onDelete(item)" class="delete-btn"></button>
                                </div>
                            }
                        </div>

                    </li>
                    }
                </ol>
                @if ((ingredients$ | async)?.length !== 0) {
                <button class="green" routerLink="/preferences" routerLinkActive="router-link-active">Next step</button>
                }
            </div>
        </div>
    </main>


</div>